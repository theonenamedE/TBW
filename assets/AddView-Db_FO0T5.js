import{_ as S,s as k,l as V}from"./api-MbKgyKRK.js";import{g as b,h as u,c as g,n as M,a as l,o as m,i as L,p as I,e as j,b as B,k as x,j as D,f as $}from"./index-Cw4ALOtH.js";import{_ as P}from"./MovieList.vue_vue_type_script_setup_true_lang-DXC6i32q.js";import{a as Q}from"./movies-DpwHlLoQ.js";const C={class:"flex items-center w-full max-w-md bg-white/70 backdrop-blur-md border border-gray-200/60 shadow-sm hover:shadow-md transition rounded-lg overflow-hidden"},E=["value"],N=b({__name:"SearchBar",props:{modelValue:{}},emits:["update:modelValue","submit"],setup(h,{emit:o}){const r=h,a=o;u(r.modelValue);function c(){a("submit")}return(n,i)=>(m(),g("form",{onSubmit:M(c,["prevent"]),class:"flex justify-center mb-8"},[l("div",C,[i[1]||(i[1]=l("span",{class:"pl-3 text-gray-400"},[l("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("circle",{cx:"11",cy:"11",r:"8"}),l("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})])],-1)),l("input",{type:"search",placeholder:"Search for a movie",required:"",value:r.modelValue,onInput:i[0]||(i[0]=v=>a("update:modelValue",v.target.value)),class:"flex-1 px-3 py-2 bg-transparent outline-none text-gray-700 placeholder-gray-400"},null,40,E)])],32))}}),A={class:"container mx-auto px-4 py-12"},T={key:0,class:"flex justify-center my-16"},q={key:2,class:"text-center text-gray-500 mt-16 bg-gray-50/60 border border-gray-200 rounded-lg py-12"},O={class:"flex justify-center pt-4"},G=b({__name:"AddView",setup(h){const o=u(),r=u(""),a=u(""),c=u({}),n=u(1),i=u(!1),v=u(!1),t=Q();async function y(){try{i.value=!0,n.value=1;const e=await k(a.value);if(!e.Response){o.value=[],r.value=e.ErrorMessage;return}r.value="";const s=Object.keys(c.value).filter(d=>e.Search.some(p=>p.imdbID===d));o.value=e.Search,t.setState(n.value,a.value,e.Search);for(const d of e.Search)s.includes(d.imdbID)||(c.value[d.imdbID]=!0)}catch(e){o.value=[],console.error(e),r.value=e.message}finally{i.value=!1}}async function _(){try{v.value=!0,n.value++;const e=await V(a.value,n.value);o.value?.push(...e.Search),t.setState(n.value,a.value,o.value?o.value:[]);for(const s of e.Search)c.value[s.imdbID]=!0}catch(e){n.value=1,r.value=e.message}finally{v.value=!1}}function w(e){c.value[e]=!1}L(()=>{t.searchQuery!==""&&t.searchPage!==0&&t.movieList!==void 0&&t.movieList.length>0&&(a.value=t.searchQuery,n.value=t.searchPage,o.value=t.movieList)});let f=null;return I(a,()=>{f&&clearTimeout(f),f=window.setTimeout(()=>{a.value.length>2&&t.searchQuery!==a.value&&y(),f=null},500)}),(e,s)=>{const d=$("motion-fade-visible-once");return j((m(),g("div",A,[s[2]||(s[2]=l("h1",{class:"text-4xl font-extrabold text-center mb-10 bg-gradient-to-r from-gray-700 to-gray-500 bg-clip-text text-transparent"}," Add a Movie ",-1)),B(N,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=p=>a.value=p),onSubmit:y},null,8,["modelValue"]),i.value?(m(),g("div",T,[...s[1]||(s[1]=[l("span",{class:"loading loading-ring loading-lg text-primary"},null,-1)])])):o.value&&o.value.length>0?(m(),x(P,{key:1,movies:o.value,"loading-images":c.value,"loading-more":v.value,onLoaded:w,onLoadMore:_,"is-search":!0},null,8,["movies","loading-images","loading-more"])):(m(),g("p",q," Search for a movie to add it to your list ")),l("div",O,[r.value?(m(),x(S,{key:0,message:r.value},null,8,["message"])):D("",!0)])])),[[d]])}}});export{G as default};
