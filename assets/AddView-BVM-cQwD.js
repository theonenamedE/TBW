import{_ as b,s as w,l as S}from"./api-Cs3POsQX.js";import{g as h,j as i,c as m,n as k,a as l,o as c,l as V,p as M,e as B,b as j,i as g,h as L,f as $}from"./index-BpwJ6Idf.js";import{_ as P}from"./MovieList.vue_vue_type_script_setup_true_lang-BDiNiyWm.js";import{a as Q}from"./movies-CPyq353D.js";const C={class:"flex items-center w-full max-w-md bg-white/70 backdrop-blur-md border border-gray-200/60 shadow-sm hover:shadow-md transition rounded-lg overflow-hidden"},E=["value"],N=h({__name:"SearchBar",props:{modelValue:{}},emits:["update:modelValue","submit"],setup(f,{emit:a}){const s=f,e=a;i(s.modelValue);function r(){e("submit")}return(d,n)=>(c(),m("form",{onSubmit:k(r,["prevent"]),class:"flex justify-center mb-8"},[l("div",C,[n[1]||(n[1]=l("span",{class:"pl-3 text-gray-400"},[l("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("circle",{cx:"11",cy:"11",r:"8"}),l("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})])],-1)),l("input",{type:"search",placeholder:"Search for a movie",required:"",value:s.modelValue,onInput:n[0]||(n[0]=t=>e("update:modelValue",t.target.value)),class:"flex-1 px-3 py-2 bg-transparent outline-none text-gray-700 placeholder-gray-400"},null,40,E)])],32))}}),A={class:"container mx-auto px-4 py-12"},D={key:0,class:"flex justify-center my-16"},I={key:2,class:"text-center text-gray-500 mt-16 bg-gray-50/60 border border-gray-200 rounded-lg py-12"},T={class:"flex justify-center pt-4"},F=h({__name:"AddView",setup(f){const a=i(),s=i(""),e=i(""),r=i(1),d=i(!1),n=i(!1),t=Q();async function p(){try{d.value=!0,r.value=1;const o=await w(e.value);if(!o.Response){a.value=[],s.value=o.ErrorMessage;return}s.value="",a.value=o.Search,t.setState(r.value,e.value,o.Search)}catch(o){a.value=[],console.error(o),s.value=o.message}finally{d.value=!1}}async function y(){try{n.value=!0,r.value++;const o=await S(e.value,r.value);a.value?.push(...o.Search),t.setState(r.value,e.value,a.value?a.value:[])}catch(o){r.value=1,s.value=o.message}finally{n.value=!1}}V(()=>{t.searchQuery!==""&&t.searchPage!==0&&t.movieList!==void 0&&t.movieList.length>0&&(e.value=t.searchQuery,r.value=t.searchPage,a.value=t.movieList)});let v=null;return M(e,()=>{v&&clearTimeout(v),v=window.setTimeout(()=>{e.value.length>2&&t.searchQuery!==e.value&&p(),v=null},500)}),(o,u)=>{const x=$("motion-fade-visible-once");return B((c(),m("div",A,[u[2]||(u[2]=l("h1",{class:"text-4xl font-extrabold text-center mb-10 bg-gradient-to-r from-gray-700 to-gray-500 bg-clip-text text-transparent"}," Add a Movie ",-1)),j(N,{modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=_=>e.value=_),onSubmit:p},null,8,["modelValue"]),d.value?(c(),m("div",D,[...u[1]||(u[1]=[l("span",{class:"loading loading-ring loading-lg text-primary"},null,-1)])])):a.value&&a.value.length>0?(c(),g(P,{key:1,movies:a.value,"loading-more":n.value,onLoadMore:y,"is-search":!0},null,8,["movies","loading-more"])):(c(),m("p",I," Search for a movie to add it to your list ")),l("div",T,[s.value?(c(),g(b,{key:0,message:s.value},null,8,["message"])):L("",!0)])])),[[x]])}}});export{F as default};
